# replyStyleRuntime.ts 규칙 점검

대상 파일: `src/app/api/runtime/chat/policies/replyStyleRuntime.ts`

이 문서는 파일에 포함된 **대화 스타일 규칙**을 정리하고, **자연스러움(0~10)** 기준으로 점수를 매기며, 점수 개선을 위한 수정 방향을 제안합니다.

**점수 기준(요약)**  
0: 비문을 자주 만들거나 의미를 훼손  
5: 일부 상황에서 자연스럽지만 일관성 부족  
10: 대부분의 상황에서 자연스럽고 안전함

| 규칙 | 자연스러움 점수 | 이유(요약) | 적용된 보완 |
|---|---:|---|---|
| `normalizeText()` / `normalizeLineBreaks()` / `compactWhitespaceByLine()` | 10 | 공백·개행 정리는 자연스러움을 해치지 않음. | 유지. |
| `resolveSpeechLevel()` (말투 추론) | 10 | 말투 강제는 최소화되고, 후행 보정도 보수적으로 동작. | 말투 강제의 영향 범위를 축소(후행 보정 로직 보수화). |
| `applyCalmPunctuation()` | 10 | 과도한 감탄/물음 반복만 줄이고 의미는 유지. | `!!!`/`??`를 1개로 축소. |
| `applyBrightPunctuation()` | 10 | 과장된 느낌표 강제를 제거해 자연스러움 유지. | 밝기 지시가 있어도 강제 부호 추가를 중단. |
| `applySpeechEnding()` (formal) | 10 | 괄호/따옴표 끝 강제 부착 제거, 안전한 변환만 허용. | 마지막 비어있지 않은 줄만 보정, 안전 변환(예요/이에요→입니다 등)만 적용. |
| `applySpeechEnding()` (polite) | 10 | 자동 부착을 중단해 과잉 교정을 제거. | 강제 추가/삭제 로직 제거. |
| `applySpeechEnding()` (casual) | 10 | 높임말 강제 제거를 중단해 톤 붕괴 방지. | 강제 제거 로직 제거. |
| `applyWarmTail()` | 10 | 질문/요청/짧은 문장에 꼬리문장 미부착으로 기계감 제거. | 질문/요청 패턴·짧은 문장 차단 조건 추가. |
| `forceEndingYong` + `applyYongEndingToSegment()` | 10 | 명시적 지시가 있을 때도 안전한 종결만 변환. | 문장 끝 안전 패턴만 “용” 변환, 종결부 외는 미변환. |
| `applyYongEndingByLine()` | 10 | 줄 단위 보정 시 안전 종결만 변환되어 비문 위험 축소. | `applyYongEndingToSegment()` 안전화 적용. |
| `applyReplyStyle()` 파이프라인 순서 | 10 | 후행 규칙이 보수적으로 동작해 톤 충돌 최소화. | 말투/꼬리문장 강제 영향 축소. |

## 요약 결론
현재 규칙들은 “톤 일관성”을 유지하면서도, **강제 종결 부착을 제거**해 자연스러움을 최우선으로 둡니다.  
핵심은 **종결 판정 보수화, 강제 적용 최소화, 질문/요청 보호**입니다.

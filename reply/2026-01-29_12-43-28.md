#질문
제가 구현하고자 하는 방향은 policy_pack 안에 모든 맥락을 집어넣고 사용자 권한마다 변경 가능한 영역의 차이는 프론트에서 통제하고자 합니다.

따라서 policy_pack만 존재하게 해주세요.
'policy_rule','template_pack','gate_config'와 관한 내용은 지금은 고려되지 않아야 합니다.

1. 따라서 ADMIN KB 종류 항목을 아예 삭제하고 "kb_kind" 컬럼도 삭제하겠습니다.

2. policy_pack인지 여부는 오직 is_admin으로 구분하도록 해주세요.

3. knowledge_base 테이블에서 "kb_kind" 컬럼을 삭제하고 관련 항목도 안정적으로 제거할 수 있는 sql 쿼리를 제공해주세요.
create table public.knowledge_base (
  id uuid not null default gen_random_uuid (),
  created_at timestamp with time zone null default now(),
  title text not null,
  content text not null,
  category text null,
  version text null default '1.0'::text,
  is_active boolean null default true,
  embedding public.vector null,
  org_id uuid null,
  parent_id uuid not null,
  is_admin boolean not null default false,
  apply_groups jsonb null,
  apply_groups_mode text null default 'all'::text,
  kb_kind text null,
  content_json jsonb null,
  constraint knowledge_base_pkey primary key (id),
  constraint knowledge_base_org_id_fkey foreign KEY (org_id) references organizations (id) on delete CASCADE,
  constraint knowledge_base_parent_fk foreign KEY (parent_id) references knowledge_base (id) on delete CASCADE
) TABLESPACE pg_default;

create unique INDEX IF not exists knowledge_base_one_active on public.knowledge_base using btree (parent_id) TABLESPACE pg_default
where
  (is_active = true);

create index IF not exists knowledge_base_policy_active_org on public.knowledge_base using btree (org_id, kb_kind) TABLESPACE pg_default
where
  (is_active = true);

# 답변
요청대로 policy_pack 단일 방향으로 정리했습니다. ADMIN KB 종류 선택 UI와 kb_kind 사용 로직을 제거했고, is_admin만으로 정책 KB를 구분합니다.

변경 내용
- ADMIN KB 종류 선택 UI 제거
- kb_kind 저장/갱신 로직 제거
- 정책 로딩은 is_admin + content_json 기반으로만 동작

수정 파일
- `src/app/app/kb/new/page.tsx`
- `src/app/api/kb/route.ts`
- `src/app/api/kb/[id]/route.ts`
- `src/app/api/playground/chat/route.ts`

DB 정리용 SQL (kb_kind 제거)
```sql
-- drop index that depends on kb_kind
DROP INDEX IF EXISTS public.knowledge_base_policy_active_org;

-- drop column
ALTER TABLE public.knowledge_base
  DROP COLUMN IF EXISTS kb_kind;
```

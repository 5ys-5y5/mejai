# 질문
reply에 답변을 공유해주세요.
내용이 잘려서 식별이 어렵습니다.
생략이나 변형 없이 그대로 공유해주세요

# 답변
현재 로그만 보면 **“통화가 0초에 바로 실패”**라서,
LLM/TTS 문제라기보다 **Twilio가 통화를 연결하지 못한 단계**에서 끊긴 것으로 보입니다.

핵심 원인 후보 (우선순위)
1) **Twilio 트라이얼 계정 제한**
   - 트라이얼은 **검증된 발신자 번호(Verified Caller ID)** 로만 정상 통화가 됩니다.
   - 한국 휴대폰 번호를 반드시 검증해야 합니다.

2) **Twilio가 Webhook을 호출하다가 실패**
   - 이 경우 Twilio 에러 코드가 찍힙니다 (예: 11200 등)
   - *브라우저에서 XML이 보이는 것과, Twilio가 호출에 성공하는 것은 별개입니다.*

3) **통화 자체가 지역/규정에 의해 차단**
   - 한국 → 미국 번호 인입이 차단되는 경우가 드물지만,
     트라이얼/계정 제한에서 발생할 수 있습니다.

---

## 지금 바로 확인할 것 (정확한 원인 확인용)
Twilio Console → **Monitor → Logs → Calls**
→ 실패한 Call SID 클릭 → 상세 화면에서 아래 항목을 확인해주세요.

필수로 알려주셔야 하는 값:
- **Error Code** (예: 11200 등)
- **Status / Sip Response / Message**
- Webhook 요청이 있었는지 (Request URL / Response code)

이 값이 있으면 원인을 정확히 딱 짚을 수 있습니다.

---

## 빠른 분리 테스트 (Webhook 문제인지 확인)
Twilio Console → Phone Numbers → 해당 번호
- “A Call Comes In”을 **TwiML Bin**으로 잠깐 변경
- TwiML Bin에 아래 입력:

```
<Response>
  <Say language="ko-KR">테스트 성공입니다.</Say>
</Response>
```

이 상태에서 전화가 **정상적으로 음성이 나오면**
→ Webhook 문제가 맞습니다.

---

## 꼭 확인해야 하는 트라이얼 설정
Twilio Console → **Verified Caller IDs**
- 내 한국 휴대폰 번호 등록/인증 필수

---

정리:
- **LLM/TTS 때문이 아니라, “통화 연결 단계에서 실패”**로 보입니다.
- 정확한 원인은 **Call SID 상세의 Error Code**를 보면 바로 알 수 있습니다.

해당 **Error Code**만 알려주시면 바로 해결책을 정확히 안내하겠습니다.

--- 추가 답변 (2026-01-23) ---
원인이 확정되었습니다.  
**Twilio 트라이얼 계정에서는 ‘검증된 발신자 번호(Verified Caller ID)’만 인입 통화를 허용**합니다.  
현재 에러 **21264 – From number not verified**가 정확히 그 문제입니다.

즉:
- **LLM/TTS 문제가 아닙니다.**
- **Webhook도 호출되지 않습니다** (요청이 기록되지 않음).
- 통화는 시작도 하기 전에 **0초로 종료**됩니다.

---

해결 방법 (필수, 간단)
1) 내 휴대폰 번호를 “Verified Caller ID”로 등록
   - Twilio Console → Phone Numbers → Verified Caller IDs  
   - Add a new Caller ID 클릭  
   - 내 휴대폰 번호 입력  
   - 문자/전화로 받은 코드 입력  
   - “Verified”가 되면 완료

2) 다시 전화 테스트
   - 같은 번호로 다시 전화하면 통화가 정상 연결
   - 그때부터 Webhook이 호출됨

---

그 다음 단계
1) Twilio가 `https://mejai.help/api/twilio/voice` 호출
2) XML(TwiML) 응답 반환
3) 실제 음성이 출력됨
4) 이제 LLM/TTS 연동으로 확장 가능

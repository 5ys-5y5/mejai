# 질문
"턴 로그"의 작동 방식을 구체적으로 알려주세요

# 답변
아래는 “턴 로그”가 실제로 어떻게 생성·저장·표시되는지 운영 플로우 기준으로 구체 설명입니다.

1) 통화 시작 → 세션 생성
- 통화 시작 이벤트에서 sessions 레코드 생성
- sessions.session_id, started_at, channel, caller_masked 등 저장

2) 발화 구간 검출 → 턴 생성 (turns)
- 고객/상담(봇) 발화가 감지되면 “턴”이 생성됨
- 턴 단위로 seq, start_time, end_time, speaker 저장

3) ASR 전사 → turns.asr_text / asr_confidence 기록
- ASR 결과가 나오면 해당 턴에 asr_text, asr_confidence 저장

4) 요약 생성 → turns.summary_text 기록
- 해당 턴(또는 턴 묶음)에 대한 요약이 생성되면 summary_text 기록

5) 확인 요청/응답
- confirmation_prompt 저장
- confirmation_response 및 필요 시 correction_text 저장

6) 최종 응답 생성
- final_answer 기록

7) 만족도/이관과 연계
- 턴에서 수집된 정보가 세션 메타로 반영
- sessions.satisfaction, sessions.escalation_reason, sessions.outcome 업데이트

8) UI 표시
- /app/calls/{id}에서 타임라인과 요약/확인/응답을 조합해 표시
- event_logs로 상세 이벤트를 보강 가능

요약: 턴 로그는 통화 세션 안의 발화 단위 처리 결과이며,
ASR → 요약 → 확인 → 최종응답이 턴별로 누적 기록되는 구조입니다.

# 질문
이 내용을 reply에 출력해주세요

# 답변
사용자 스키마 정보를 기준으로 **권한/플랜 저장 구조**를 추가했고, **admin 버튼 노출 조건**은 `user_profiles.is_admin`로 전환했습니다.
또한 “후속 지원 요청” 뱃지는 실데이터로 이미 변경되어 있습니다.

추가된 DB 스키마(실행 필요)
- `docs/user_schema_patch.sql`
  - `user_profiles` : `plan`(starter/pro/enterprise), `is_admin`
  - `org_members` : 조직 내 역할(`owner`/`operator`/`auditor`)

API 추가
- `GET /api/user-profile` → `user_profiles` 조회
  - `src/app/api/user-profile/route.ts`

프론트 변경
- `/app`에서 admin 여부를 `/api/user-profile`로 판단하도록 수정
  - `src/app/app/page.tsx`

체크리스트 업데이트
- `docs/단계별_구현_체크리스트_및_검증.md`에
  - 사용자 프로필 API 연동 [x]
  - 사용자 권한/플랜 스키마 적용 [ ] (SQL 실행 필요)

다음으로 해야 할 작업 (필수)
1) Supabase SQL Editor에서 `docs/user_schema_patch.sql` 실행
2) `user_profiles`에 현재 사용자 레코드 삽입
   - 예시:
```sql
insert into public.user_profiles (user_id, plan, is_admin)
values ('4250c165-a1db-4f26-be51-32869e43ad70', 'pro', true);
```

이후부터 “통화 시뮬레이션 생성” 버튼은 **is_admin = true**인 계정에서만 보입니다.

요청하신 “실제 통화 처리 로직(턴/이벤트 흐름 강화)”는 이미 `/api/sessions/{id}/process`로 단계별 처리 API를 추가해 두었습니다.
원하시면 다음 단계로 **프론트에서 버튼/액션으로 이 API를 순차 호출**하는 UI까지 바로 진행하겠습니다.
